<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8" />
<title>ç©¶æ¥µã®2æŠ æ€§æ ¼ã‚²ãƒ¼ãƒ </title>
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
<style>
  * { box-sizing: border-box; margin: 0; padding: 0; }
  
  body {
    margin: 0;
    background: linear-gradient(135deg, #0f0c29, #302b63, #24243e);
    background-size: 400% 400%;
    animation: gradientShift 15s ease infinite;
    color: #f7f7f7;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;
    display: flex;
    justify-content: center;
    align-items: center;
    min-height: 100vh;
    overflow-x: hidden;
    position: relative;
  }

  @keyframes gradientShift {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
  }

  /* èƒŒæ™¯ãƒ‘ãƒ¼ãƒ†ã‚£ã‚¯ãƒ« */
  .particles {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
    z-index: 1;
  }

  .particle {
    position: absolute;
    width: 4px;
    height: 4px;
    background: rgba(255, 255, 255, 0.3);
    border-radius: 50%;
    animation: float 20s infinite;
  }

  @keyframes float {
    0%, 100% { transform: translateY(0) translateX(0); opacity: 0; }
    10% { opacity: 1; }
    90% { opacity: 1; }
    100% { transform: translateY(-100vh) translateX(100px); opacity: 0; }
  }

  #confetti-canvas {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
    z-index: 999;
  }

  .card {
    background: rgba(24, 24, 24, 0.95);
    backdrop-filter: blur(10px);
    border: 2px solid rgba(255, 255, 255, 0.1);
    border-radius: 24px;
    padding: 30px 24px;
    max-width: 580px;
    width: 95%;
    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.8);
    text-align: center;
    position: relative;
    z-index: 10;
    animation: cardEntry 0.6s cubic-bezier(0.34, 1.56, 0.64, 1);
  }

  @keyframes cardEntry {
    from { opacity: 0; transform: scale(0.8) translateY(50px); }
    to { opacity: 1; transform: scale(1) translateY(0); }
  }

  /* ãƒ˜ãƒƒãƒ€ãƒ¼ */
  h1 {
    margin: 0.2em 0 0.6em;
    font-size: 1.6rem;
    letter-spacing: 0.05em;
    background: linear-gradient(135deg, #f5b642, #e50914);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    font-weight: 900;
    text-shadow: 0 0 30px rgba(245, 182, 66, 0.5);
    animation: titleGlow 2s ease-in-out infinite;
  }

  @keyframes titleGlow {
    0%, 100% { filter: brightness(1); }
    50% { filter: brightness(1.3); }
  }

  .subtitle {
    color: #ccc;
    font-size: 0.95rem;
    line-height: 1.6;
    margin: 0.8em 0;
  }

  /* ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ãƒãƒ¼ */
  .progress-wrapper {
    margin: 20px 0 10px;
  }

  .progress-bar-container {
    background: rgba(255, 255, 255, 0.1);
    height: 10px;
    border-radius: 10px;
    overflow: hidden;
    position: relative;
    margin-bottom: 8px;
  }

  .progress-bar-fill {
    height: 100%;
    background: linear-gradient(90deg, #e50914, #f5b642);
    transition: width 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
    border-radius: 10px;
    position: relative;
    overflow: hidden;
  }

  .progress-bar-fill::after {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
    animation: shimmer 2s infinite;
  }

  @keyframes shimmer {
    0% { transform: translateX(-100%); }
    100% { transform: translateX(100%); }
  }

  .progress-text {
    display: flex;
    justify-content: space-between;
    font-size: 0.85rem;
    color: #aaa;
  }

  .mode-badge {
    display: inline-block;
    padding: 6px 14px;
    border-radius: 20px;
    font-size: 0.8rem;
    font-weight: 700;
    margin-bottom: 15px;
    animation: badgePulse 2s ease-in-out infinite;
  }

  .mode-hell {
    background: linear-gradient(135deg, #e50914, #8b0000);
    box-shadow: 0 4px 15px rgba(229, 9, 20, 0.4);
  }

  .mode-heaven {
    background: linear-gradient(135deg, #f5b642, #ffd700);
    box-shadow: 0 4px 15px rgba(245, 182, 66, 0.4);
    color: #111;
  }

  @keyframes badgePulse {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.05); }
  }

  /* è³ªå•ã‚¨ãƒªã‚¢ */
  .question {
    margin: 1.5em 0;
    font-size: 1.15rem;
    line-height: 1.6;
    font-weight: 700;
    min-height: 4em;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 15px;
    background: rgba(255, 255, 255, 0.05);
    border-radius: 15px;
    animation: questionSlide 0.5s ease-out;
  }

  @keyframes questionSlide {
    from { opacity: 0; transform: translateX(-30px); }
    to { opacity: 1; transform: translateX(0); }
  }

  /* é¸æŠè‚¢ */
  .choices {
    display: flex;
    flex-direction: column;
    gap: 15px;
    margin: 20px 0;
  }

  .btn {
    border: none;
    border-radius: 999px;
    padding: 18px 22px;
    font-size: 1.05rem;
    cursor: pointer;
    transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
    -webkit-tap-highlight-color: transparent;
    text-decoration: none;
    font-weight: 600;
    position: relative;
    overflow: hidden;
  }

  .btn::before {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    width: 0;
    height: 0;
    border-radius: 50%;
    background: rgba(255, 255, 255, 0.4);
    transform: translate(-50%, -50%);
    transition: width 0.6s, height 0.6s;
  }

  .btn:active::before {
    width: 300px;
    height: 300px;
  }

  .btn:active {
    transform: scale(0.95);
  }

  .choice {
    background: linear-gradient(135deg, rgba(37, 37, 37, 0.8), rgba(50, 50, 50, 0.8));
    color: #fff;
    border: 2px solid rgba(255, 255, 255, 0.15);
    text-align: left;
    line-height: 1.5;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
    position: relative;
    z-index: 1;
  }

  .choice:hover {
    transform: translateY(-3px);
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.5);
    border-color: rgba(255, 255, 255, 0.3);
  }

  .choice.selectedA {
    border-color: #f5b642;
    background: linear-gradient(135deg, rgba(245, 182, 66, 0.3), rgba(255, 215, 0, 0.2));
    box-shadow: 0 0 30px rgba(245, 182, 66, 0.5);
    animation: selectedPulse 0.5s ease-out;
  }

  .choice.selectedB {
    border-color: #e50914;
    background: linear-gradient(135deg, rgba(229, 9, 20, 0.3), rgba(139, 0, 0, 0.2));
    box-shadow: 0 0 30px rgba(229, 9, 20, 0.5);
    animation: selectedPulse 0.5s ease-out;
  }

  @keyframes selectedPulse {
    0% { transform: scale(1); }
    50% { transform: scale(1.05); }
    100% { transform: scale(1); }
  }

  .main {
    background: linear-gradient(135deg, #e50914, #f5b642);
    color: #fff;
    font-weight: 700;
    width: 100%;
    display: block;
    box-shadow: 0 6px 20px rgba(229, 9, 20, 0.4);
    font-size: 1.15rem;
    padding: 20px;
  }

  .main:hover {
    transform: translateY(-3px);
    box-shadow: 0 10px 30px rgba(229, 9, 20, 0.6);
  }

  .line-btn {
    background: linear-gradient(135deg, #06C755, #00a843);
    color: #fff;
    font-weight: 700;
    width: 100%;
    margin-bottom: 15px;
    display: block;
    text-align: center;
    line-height: 1.3;
    padding: 20px;
    box-shadow: 0 6px 20px rgba(6, 199, 85, 0.4);
  }

  .line-btn:hover {
    transform: translateY(-3px);
    box-shadow: 0 10px 30px rgba(6, 199, 85, 0.6);
  }

  .sub {
    background: rgba(42, 42, 42, 0.8);
    color: #fff;
    border: 1px solid rgba(255, 255, 255, 0.2);
    flex: 1;
  }

  .sub:hover {
    background: rgba(60, 60, 60, 0.9);
    border-color: rgba(255, 255, 255, 0.4);
  }

  .danger {
    background: linear-gradient(135deg, #e50914, #8b0000);
    color: #fff;
    font-weight: 700;
    width: 100%;
    box-shadow: 0 6px 20px rgba(229, 9, 20, 0.4);
  }

  .danger:disabled {
    opacity: 0.4;
    cursor: not-allowed;
    transform: none;
  }

  .danger:hover:not(:disabled) {
    transform: translateY(-3px);
    box-shadow: 0 10px 30px rgba(229, 9, 20, 0.6);
  }

  .nav {
    display: flex;
    gap: 12px;
    margin-top: 15px;
    flex-direction: column;
  }

  /* ç”»åƒ */
  img.hero {
    width: 100%;
    max-width: 300px;
    display: block;
    margin: 15px auto;
    border-radius: 15px;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
    animation: imageFloat 3s ease-in-out infinite;
  }

  @keyframes imageFloat {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-10px); }
  }

  /* çµæœç”»é¢ã®å††ã‚°ãƒ©ãƒ• */
  .chart-container {
    position: relative;
    width: 200px;
    height: 200px;
    margin: 25px auto;
  }

  .chart-svg {
    transform: rotate(-90deg);
    filter: drop-shadow(0 0 15px currentColor);
  }

  .chart-bg {
    fill: none;
    stroke: rgba(255, 255, 255, 0.1);
    stroke-width: 18;
  }

  .chart-bar {
    fill: none;
    stroke-width: 18;
    stroke-linecap: round;
    transition: stroke-dasharray 1.5s cubic-bezier(0.34, 1.56, 0.64, 1);
  }

  .chart-text {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-weight: 900;
    font-size: 2.5rem;
    text-shadow: 0 0 20px currentColor;
    animation: scoreCount 1.5s ease-out;
  }

  @keyframes scoreCount {
    from { opacity: 0; transform: translate(-50%, -50%) scale(0.5); }
    to { opacity: 1; transform: translate(-50%, -50%) scale(1); }
  }

  /* ãƒ©ãƒ³ã‚¯ãƒãƒƒã‚¸ */
  .rank-badge {
    display: inline-block;
    padding: 15px 30px;
    border-radius: 50px;
    font-size: 1.3rem;
    font-weight: 900;
    margin: 20px auto;
    text-transform: uppercase;
    letter-spacing: 0.1em;
    animation: rankEntry 0.8s cubic-bezier(0.34, 1.56, 0.64, 1);
  }

  @keyframes rankEntry {
    from { opacity: 0; transform: scale(0.5) rotate(-10deg); }
    to { opacity: 1; transform: scale(1) rotate(0); }
  }

  .rank-gold {
    background: linear-gradient(135deg, #f5b642, #ffd700);
    color: #111;
    box-shadow: 0 10px 40px rgba(245, 182, 66, 0.6);
  }

  .rank-red {
    background: linear-gradient(135deg, #e50914, #8b0000);
    color: #fff;
    box-shadow: 0 10px 40px rgba(229, 9, 20, 0.6);
  }

  .rank-normal {
    background: linear-gradient(135deg, #666, #999);
    color: #fff;
    box-shadow: 0 10px 40px rgba(100, 100, 100, 0.4);
  }

  /* ãƒŸãƒƒã‚·ãƒ§ãƒ³ãƒœãƒƒã‚¯ã‚¹ */
  .mission-box {
    background: rgba(20, 20, 20, 0.95);
    border: 2px solid #f5b642;
    padding: 25px;
    border-radius: 15px;
    margin: 25px 0;
    text-align: left;
    box-shadow: 0 0 30px rgba(245, 182, 66, 0.3);
    animation: missionPulse 2s ease-in-out infinite;
  }

  @keyframes missionPulse {
    0%, 100% { box-shadow: 0 0 30px rgba(245, 182, 66, 0.3); }
    50% { box-shadow: 0 0 50px rgba(245, 182, 66, 0.6); }
  }

  /* ãƒˆãƒ©ãƒ³ã‚¸ã‚·ãƒ§ãƒ³ç”»é¢ */
  .transition-content {
    animation: transitionZoom 1s ease-out;
  }

  @keyframes transitionZoom {
    0% { opacity: 0; transform: scale(1.5) rotate(5deg); }
    100% { opacity: 1; transform: scale(1) rotate(0); }
  }

  /* ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ– */
  @media (max-width: 600px) {
    h1 { font-size: 1.4rem; }
    .question { font-size: 1.05rem; min-height: 3.5em; }
    .btn { font-size: 1rem; padding: 16px 20px; }
    .chart-container { width: 180px; height: 180px; }
    .chart-text { font-size: 2rem; }
  }

  /* ã‚·ã‚§ã‚¢ãƒœã‚¿ãƒ³ */
  .share-section {
    margin-top: 30px;
    padding-top: 25px;
    border-top: 1px solid rgba(255, 255, 255, 0.2);
  }

  .share-title {
    font-size: 1.1rem;
    font-weight: 700;
    margin-bottom: 15px;
    color: #f5b642;
  }

  .share-buttons {
    display: flex;
    gap: 12px;
    flex-wrap: wrap;
  }

  .share-btn {
    flex: 1;
    min-width: 140px;
    padding: 14px 20px;
    border-radius: 50px;
    text-decoration: none;
    color: #fff;
    font-weight: 700;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    transition: all 0.3s ease;
  }

  .share-x {
    background: linear-gradient(135deg, #000, #333);
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.4);
  }

  .share-line {
    background: linear-gradient(135deg, #06C755, #00a843);
    box-shadow: 0 4px 15px rgba(6, 199, 85, 0.4);
  }

  .share-btn:hover {
    transform: translateY(-3px);
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.5);
  }
</style>
</head>

<body>
<!-- èƒŒæ™¯ãƒ‘ãƒ¼ãƒ†ã‚£ã‚¯ãƒ« -->
<div class="particles" id="particles"></div>

<!-- ç´™å¹é›ªã‚­ãƒ£ãƒ³ãƒã‚¹ -->
<canvas id="confetti-canvas"></canvas>

<!-- ãƒ¡ã‚¤ãƒ³ã‚«ãƒ¼ãƒ‰ -->
<div class="card" id="app"></div>

<script>
/* =========================================================
   åŸºæœ¬è¨­å®š & ãƒªãƒ³ã‚¯
========================================================= */
const STICKER_URL = "https://line.me/S/shop/sticker/author/5729491";
const ENNEA_URL = "https://ennea5w4.github.io/enneagram-test/";

const dogImages = {
  1: "img/dog_type01.png", 2: "img/dog_type02.png", 3: "img/dog_type03.png",
  4: "img/dog_type04.png", 5: "img/dog_type05.png", 6: "img/dog_type06.png",
  7: "img/dog_type07.png", 8: "img/dog_type08.png", 9: "img/dog_type09.png"
};
function getDogImg(t) { return dogImages[t] || dogImages[5]; }

/* =========================================================
   ãƒ‡ãƒ¼ã‚¿ï¼ˆ2æŠ32å•ï¼‰
========================================================= */
const questions32 = [
  {q:"å«Œã‚ã‚Œãªã„äººç”Ÿ vs ãªã‚ã‚‰ã‚Œãªã„äººç”Ÿ",A:"å«Œã‚ã‚Œãªã„",B:"ãªã‚ã‚‰ã‚Œãªã„"},
  {q:"ãšã£ã¨è¬ã‚Šç¶šã‘ã‚‹ vs ãšã£ã¨è¨€ã„è¨³ã—ç¶šã‘ã‚‹",A:"è¬ã‚Šç¶šã‘ã‚‹",B:"è¨€ã„è¨³ã—ç¶šã‘ã‚‹"},
  {q:"ä¸€ç”Ÿæ°—ã¾ãšã„æ²ˆé»™ vs ä¸€ç”Ÿæµ…ã„é›‘è«‡",A:"æ°—ã¾ãšã„æ²ˆé»™",B:"æµ…ã„é›‘è«‡"},
  {q:"æ¯æ—¥ä¸Šå¸ã«è©°ã‚ã‚‰ã‚Œã‚‹ vs æ¯æ—¥éƒ¨ä¸‹ã«è£åˆ‡ã‚‰ã‚Œã‚‹",A:"ä¸Šå¸ã«è©°ã‚ã‚‰ã‚Œã‚‹",B:"éƒ¨ä¸‹ã«è£åˆ‡ã‚‰ã‚Œã‚‹"},
  {q:"ä¸€ç”Ÿé ¼ã‚Œãªã„ vs ä¸€ç”Ÿé ¼ã‚‰ã‚Œã™ãã‚‹",A:"é ¼ã‚Œãªã„",B:"é ¼ã‚‰ã‚Œã™ãã‚‹"},
  {q:"ä¸€ç”Ÿæœ¬éŸ³ã—ã‹è¨€ãˆãªã„ vs ä¸€ç”Ÿã‚¦ã‚½ã—ã‹è¨€ãˆãªã„",A:"æœ¬éŸ³ã—ã‹è¨€ãˆãªã„",B:"ã‚¦ã‚½ã—ã‹è¨€ãˆãªã„"},
  {q:"ä¸€ç”Ÿäºˆå®šãŒç‹‚ã† vs ä¸€ç”Ÿäºˆå®šé€šã‚Šã§é€€å±ˆ",A:"äºˆå®šãŒç‹‚ã†",B:"äºˆå®šé€šã‚Šã§é€€å±ˆ"},
  {q:"ä¸€ç”Ÿèª¤è§£ã•ã‚Œç¶šã‘ã‚‹ vs ä¸€ç”ŸæœŸå¾…ã•ã‚Œç¶šã‘ã‚‹",A:"èª¤è§£ã•ã‚Œç¶šã‘ã‚‹",B:"æœŸå¾…ã•ã‚Œç¶šã‘ã‚‹"},
  {q:"ä¸€ç”Ÿé¸æŠã‚’è¿«ã‚‰ã‚Œã‚‹ vs ä¸€ç”Ÿé¸æŠè‚¢ãŒãªã„",A:"é¸æŠã‚’è¿«ã‚‰ã‚Œã‚‹",B:"é¸æŠè‚¢ãŒãªã„"},
  {q:"ä¸€ç”Ÿç›¸è«‡ã•ã‚Œãªã„ vs ä¸€ç”Ÿç›¸è«‡ã•ã‚Œç¶šã‘ã‚‹",A:"ç›¸è«‡ã•ã‚Œãªã„",B:"ç›¸è«‡ã•ã‚Œç¶šã‘ã‚‹"},
  {q:"ä¸€ç”Ÿè©•ä¾¡ã•ã‚Œãªã„åŠªåŠ› vs ä¸€ç”Ÿè©•ä¾¡ã•ã‚Œã‚‹å®ŸåŠ›ä¸è¶³",A:"è©•ä¾¡ã•ã‚Œãªã„åŠªåŠ›",B:"è©•ä¾¡ã•ã‚Œã‚‹å®ŸåŠ›ä¸è¶³"},
  {q:"ä¸€ç”Ÿäºˆå®šã‚’å®ˆã‚‰ã•ã‚Œã‚‹ vs ä¸€ç”Ÿäºˆå®šã‚’å®ˆã‚‰ã‚Œãªã„",A:"å®ˆã‚‰ã•ã‚Œã‚‹",B:"å®ˆã‚‰ã‚Œãªã„"},
  {q:"ä¸€ç”Ÿäººã«åˆã‚ã›ç¶šã‘ã‚‹ vs ä¸€ç”Ÿäººã«åˆã‚ã›ã¦ã‚‚ã‚‰ã†",A:"åˆã‚ã›ç¶šã‘ã‚‹",B:"åˆã‚ã›ã¦ã‚‚ã‚‰ã†"},
  {q:"ä¸€ç”Ÿå®‰å¿ƒã§ããªã„æˆåŠŸ vs ä¸€ç”Ÿå®‰å¿ƒã ã‘ã®å¤±æ•—",A:"å®‰å¿ƒã§ããªã„æˆåŠŸ",B:"å®‰å¿ƒã ã‘ã®å¤±æ•—"},
  {q:"ä¸€ç”Ÿæ³¨ç›®ã•ã‚Œç¶šã‘ã‚‹ vs ä¸€ç”Ÿå­˜åœ¨æ„Ÿã‚¼ãƒ­",A:"æ³¨ç›®ã•ã‚Œç¶šã‘ã‚‹",B:"å­˜åœ¨æ„Ÿã‚¼ãƒ­"},
  {q:"ä¸€ç”Ÿèª°ã‹ã«ä¾å­˜ã•ã‚Œã‚‹ vs ä¸€ç”Ÿèª°ã«ã‚‚é ¼ã‚‰ã‚Œãªã„",A:"èª°ã‹ã«ä¾å­˜ã•ã‚Œã‚‹",B:"èª°ã«ã‚‚é ¼ã‚‰ã‚Œãªã„"},
  {q:"ä¸€ç”Ÿå®‰å¿ƒ vs ä¸€ç”Ÿãƒ¯ã‚¯ãƒ¯ã‚¯",A:"å®‰å¿ƒ",B:"ãƒ¯ã‚¯ãƒ¯ã‚¯"},
  {q:"ä¸€ç”Ÿç†è§£ã•ã‚Œã‚‹ vs ä¸€ç”Ÿè‡ªç”±ã§ã„ã‚‰ã‚Œã‚‹",A:"ç†è§£ã•ã‚Œã‚‹",B:"è‡ªç”±ã§ã„ã‚‰ã‚Œã‚‹"},
  {q:"ä¸€ç”ŸãŠé‡‘ã«å›°ã‚‰ãªã„ vs ä¸€ç”Ÿæ™‚é–“ã«è¿½ã‚ã‚Œãªã„",A:"ãŠé‡‘ã«å›°ã‚‰ãªã„",B:"æ™‚é–“ã«è¿½ã‚ã‚Œãªã„"},
  {q:"ç§°è³›ã•ã‚Œã‚‹å¤©æ‰ vs æ„›ã•ã‚Œã‚‹å‡¡äºº",A:"ç§°è³›ã•ã‚Œã‚‹å¤©æ‰",B:"æ„›ã•ã‚Œã‚‹å‡¡äºº"},
  {q:"ä¸€ç”Ÿè‡ªä¿¡ãŒã‚ã‚‹ vs ä¸€ç”Ÿä¸å®‰ãŒãªã„",A:"è‡ªä¿¡ãŒã‚ã‚‹",B:"ä¸å®‰ãŒãªã„"},
  {q:"ä¸€ç”Ÿå¿ƒãŒç©ã‚„ã‹ vs ä¸€ç”Ÿæ„Ÿå‹•ãŒå¤šã„",A:"å¿ƒãŒç©ã‚„ã‹",B:"æ„Ÿå‹•ãŒå¤šã„"},
  {q:"ä¸€ç”Ÿå¥½ããªã“ã¨ã ã‘ vs ä¸€ç”Ÿå¾—æ„ãªã“ã¨ã ã‘",A:"å¥½ããªã“ã¨ã ã‘",B:"å¾—æ„ãªã“ã¨ã ã‘"},
  {q:"ä¸€ç”Ÿã²ã¨ã‚Šæ™‚é–“ãŸã£ã·ã‚Š vs ä¸€ç”Ÿä»²é–“ã¨ä¸€ç·’",A:"ã²ã¨ã‚Šæ™‚é–“",B:"ä»²é–“ã¨ä¸€ç·’"},
  {q:"ä¸€ç”Ÿä»Šã®ã¾ã¾ã§OKã¨è¨€ã‚ã‚Œã‚‹ vs ä¸€ç”Ÿã‚‚ã£ã¨æœŸå¾…ã•ã‚Œã‚‹",A:"ä»Šã®ã¾ã¾ã§OK",B:"ã‚‚ã£ã¨æœŸå¾…ã•ã‚Œã‚‹"},
  {q:"ä¸€ç”Ÿå¤±æ•—ã—ãªã„ vs ä¸€ç”Ÿå¾Œæ‚”ã—ãªã„",A:"å¤±æ•—ã—ãªã„",B:"å¾Œæ‚”ã—ãªã„"},
  {q:"ä¸€ç”Ÿèª°ã‹ã®ä¸€ç•ª vs ä¸€ç”Ÿã¿ã‚“ãªã«å¥½ã‹ã‚Œã‚‹",A:"èª°ã‹ã®ä¸€ç•ª",B:"ã¿ã‚“ãªã«å¥½ã‹ã‚Œã‚‹"},
  {q:"ä¸€ç”Ÿè‡ªåˆ†ã‚’ä¿¡ã˜ã‚‰ã‚Œã‚‹ vs ä¸€ç”Ÿäººã‚’ä¿¡ã˜ã‚‰ã‚Œã‚‹",A:"è‡ªåˆ†ã‚’ä¿¡ã˜ã‚‰ã‚Œã‚‹",B:"äººã‚’ä¿¡ã˜ã‚‰ã‚Œã‚‹"},
  {q:"ä¸€ç”Ÿå¿…è¦ã¨ã•ã‚Œã‚‹ vs ä¸€ç”Ÿå°Šæ•¬ã•ã‚Œã‚‹",A:"å¿…è¦ã¨ã•ã‚Œã‚‹",B:"å°Šæ•¬ã•ã‚Œã‚‹"},
  {q:"ä¸€ç”Ÿç©ã‚„ã‹ãªæ—¥å¸¸ vs ä¸€ç”Ÿå¿˜ã‚Œã‚‰ã‚Œãªã„ç¬é–“",A:"ç©ã‚„ã‹ãªæ—¥å¸¸",B:"å¿˜ã‚Œã‚‰ã‚Œãªã„ç¬é–“"},
  {q:"ä¸€ç”Ÿé¸ã°ã‚Œã‚‹å´ vs ä¸€ç”Ÿé¸ã¶å´",A:"é¸ã°ã‚Œã‚‹å´",B:"é¸ã¶å´"},
  {q:"ä¸€ç”Ÿè‡ªåˆ†ã‚’å¥½ãã§ã„ã‚‰ã‚Œã‚‹ vs ä¸€ç”Ÿæ„›ã•ã‚Œç¶šã‘ã‚‹",A:"è‡ªåˆ†ã‚’å¥½ãã§ã„ã‚‰ã‚Œã‚‹",B:"æ„›ã•ã‚Œç¶šã‘ã‚‹"}
];
const rainyAnswers32 = ["B","A","A","A","A","A","B","A","A","A","A","A","A","A","B","B","A","B","B","A","B","A","A","A","A","B","B","B","B","A","B","A"];

let index32 = 0;
let ans32 = [];

/* =========================================================
   èƒŒæ™¯ãƒ‘ãƒ¼ãƒ†ã‚£ã‚¯ãƒ«ç”Ÿæˆ
========================================================= */
function createParticles() {
  const container = document.getElementById('particles');
  for (let i = 0; i < 30; i++) {
    const particle = document.createElement('div');
    particle.className = 'particle';
    particle.style.left = Math.random() * 100 + '%';
    particle.style.animationDelay = Math.random() * 20 + 's';
    particle.style.animationDuration = (15 + Math.random() * 10) + 's';
    container.appendChild(particle);
  }
}
createParticles();

/* =========================================================
   ç”»é¢ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°
========================================================= */
function renderStart() {
  stopConfetti();
  app.innerHTML = `
    <h1>ğŸ® ç©¶æ¥µã®2æŠ<br>æ€§æ ¼ã‚²ãƒ¼ãƒ </h1>
    <img class="hero" src="${getDogImg(5)}" alt="ã‚¿ã‚¤ãƒ—5">
    <p class="subtitle">æ–°å¹´ä¼šã‚’ç››ã‚Šä¸Šã’ã‚‹<strong>æ€è€ƒã‚·ãƒ³ã‚¯ãƒ­è¨ºæ–­</strong><br>ã‚ãªãŸã®è€ƒãˆã¯ä½œè€…Rainyã¨ä¸€è‡´ã™ã‚‹ã‹ï¼Ÿ</p>
    <button class="btn main" onclick="startTwoChoice()">âœ¨ ã‚²ãƒ¼ãƒ é–‹å§‹ âœ¨</button>
  `;
}

function startTwoChoice() {
  index32 = 0;
  ans32 = [];
  renderQuestion32();
}

function next32() {
  if (index32 === 15) {
    renderTransition();
    return;
  }
  index32++;
  if (index32 >= questions32.length) {
    renderResult32();
  } else {
    renderQuestion32();
  }
}

function prev32() {
  if (index32 === 0) {
    renderStart();
    return;
  }
  if (index32 === 16) {
    renderTransition();
    return;
  }
  index32--;
  renderQuestion32();
}

function renderQuestion32() {
  const q = questions32[index32];
  const a = ans32[index32];
  const mode = index32 < 16 ? "åœ°ç„" : "å¤©å›½";
  const modeClass = index32 < 16 ? "mode-hell" : "mode-heaven";
  const progress = ((index32 + 1) / 32) * 100;
  
  app.innerHTML = `
    <div class="mode-badge ${modeClass}">${mode}ãƒ¢ãƒ¼ãƒ‰</div>
    <div class="progress-wrapper">
      <div class="progress-bar-container">
        <div class="progress-bar-fill" style="width: ${progress}%"></div>
      </div>
      <div class="progress-text">
        <span>Q${index32 + 1} / 32</span>
        <span>æ®‹ã‚Š ${32 - index32} å•</span>
      </div>
    </div>
    <div class="question">${escapeHtml(q.q)}</div>
    <div class="choices">
      <button class="btn choice ${a === 'A' ? 'selectedA' : ''}" onclick="selectAnswer('A')">
        ${escapeHtml(q.A)}
      </button>
      <button class="btn choice ${a === 'B' ? 'selectedB' : ''}" onclick="selectAnswer('B')">
        ${escapeHtml(q.B)}
      </button>
    </div>
    <div class="nav">
      <button class="btn sub" onclick="prev32()">â† æˆ»ã‚‹</button>
      <button class="btn danger" onclick="next32()" ${!a ? 'disabled' : ''}>
        ${index32 === 31 ? 'ğŸ¯ çµæœã¸' : 'æ¬¡ã¸ â†’'}
      </button>
    </div>
  `;
}

function selectAnswer(choice) {
  ans32[index32] = choice;
  // ãƒã‚¤ãƒ–ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆå¯¾å¿œãƒ‡ãƒã‚¤ã‚¹ã®ã¿ï¼‰
  if (navigator.vibrate) {
    navigator.vibrate(50);
  }
  renderQuestion32();
}

function renderTransition() {
  app.innerHTML = `
    <div class="transition-content">
      <h1 style="font-size: 2rem;">ğŸ”¥ åœ°ç„ãƒ¢ãƒ¼ãƒ‰çµ‚äº†ï¼</h1>
      <img class="hero" src="img/transition_hell_to_heaven.png" alt="å¤©å›½ã¸" style="max-width: 350px;">
      <p class="subtitle" style="font-size: 1.1rem;">ã“ã“ã‹ã‚‰ã¯ã€Œç©¶æ¥µã®å¹¸ã›ã€ã‚’é¸ã¶<br><strong style="color: #f5b642; font-size: 1.3rem;">âœ¨ å¤©å›½ãƒ¢ãƒ¼ãƒ‰ âœ¨</strong>çªå…¥ã§ã™ï¼</p>
      <button class="btn main" onclick="index32=16;renderQuestion32()" style="font-size: 1.2rem; padding: 22px;">
        ğŸŒŸ å¤©å›½ã¸é€²ã‚€ â†’
      </button>
    </div>
  `;
}

function renderResult32() {
  let rainy = 0;
  ans32.forEach((a, i) => {
    if (a === rainyAnswers32[i]) rainy++;
  });
  const percent = Math.round((rainy / 32) * 100);
  
  let status = "æ™®é€šã®äºº";
  let rankClass = "rank-normal";
  let chartColor = "#999";
  let message = "ã‚ãªãŸã¯æ¨™æº–çš„ãªæ€è€ƒãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’æŒã£ã¦ã„ã¾ã™ã€‚";
  
  if (rainy >= 26) {
    status = "ğŸ† ã‚½ã‚¦ãƒ«ãƒ¡ã‚¤ãƒˆ";
    rankClass = "rank-gold";
    chartColor = "#f5b642";
    message = "æ™¯å“å¯¾è±¡ï¼ã‚ãªãŸã¨Rainyã¯é‹å‘½ã®èµ¤ã„ç³¸ã§çµã°ã‚Œã¦ã„ã¾ã™ï¼";
    startConfetti();
  } else if (rainy <= 8) {
    status = "ğŸ‘½ ç•°æ˜Ÿäºº";
    rankClass = "rank-red";
    chartColor = "#e50914";
    message = "ç½°ã‚²ãƒ¼ãƒ å¯¾è±¡ï¼ã‚ãªãŸã¯åœ°çƒå¤–ç”Ÿå‘½ä½“ã®å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™...";
  } else if (rainy >= 20) {
    status = "ğŸŒŸ è¦ªå‹å€™è£œ";
    chartColor = "#f5b642";
    message = "ã‹ãªã‚Šé«˜ã„ä¸€è‡´ç‡ï¼æ°—ãŒåˆã„ãã†ã§ã™ã€‚";
  } else if (rainy <= 12) {
    status = "âš ï¸ è¦æ³¨æ„äººç‰©";
    chartColor = "#e50914";
    message = "æ€è€ƒå›è·¯ãŒå¤§ããç•°ãªã‚Šã¾ã™ã€‚ã”æ³¨æ„ã‚’...";
  }
  
  const circumference = 2 * Math.PI * 75;
  const dashArray = (circumference * percent) / 100;
  
  app.innerHTML = `
    <div class="rank-badge ${rankClass}">${status}</div>
    
    <div class="chart-container">
      <svg class="chart-svg" width="200" height="200">
        <circle class="chart-bg" cx="100" cy="100" r="75"></circle>
        <circle class="chart-bar" cx="100" cy="100" r="75" 
          style="stroke: ${chartColor}; stroke-dasharray: ${dashArray} ${circumference}">
        </circle>
      </svg>
      <div class="chart-text" style="color: ${chartColor}">${rainy}</div>
    </div>
    
    <p class="subtitle" style="font-size: 1.1rem;">
      <strong style="color: ${chartColor}; font-size: 1.4rem;">${percent}%</strong><br>
      Rainyã¨ã®ã‚·ãƒ³ã‚¯ãƒ­ç‡
    </p>
    
    <p style="margin: 20px 0; line-height: 1.7; color: #ddd;">
      ${message}
    </p>
    
    <div class="share-section">
      <div class="share-title">ğŸ“± çµæœã‚’ã‚·ã‚§ã‚¢ã—ã‚ˆã†</div>
      <div class="share-buttons">
        <a href="#" class="share-btn share-x" onclick="shareToX(${rainy}, ${percent}, '${status}'); return false;">
          ğ• ã§ã‚·ã‚§ã‚¢
        </a>
        <a href="#" class="share-btn share-line" onclick="shareToLine(${rainy}, ${percent}, '${status}'); return false;">
          LINE ã§ã‚·ã‚§ã‚¢
        </a>
      </div>
    </div>
    
    <div class="nav" style="margin-top: 25px;">
      <a href="${ENNEA_URL}" target="_blank" class="btn main">
        ğŸ¯ ã‚¨ãƒ‹ã‚¢ã‚°ãƒ©ãƒ è¨ºæ–­ã¸
      </a>
      <button class="btn danger" onclick="renderPenalty()">
        ğŸ æ™¯å“ãƒ»ç½°ã‚²ãƒ¼ãƒ ç™ºè¡¨
      </button>
      <button class="btn sub" onclick="renderStart()">
        ğŸ  TOPã¸æˆ»ã‚‹
      </button>
    </div>
  `;
}

function renderPenalty() {
  stopConfetti();
  app.innerHTML = `
    <h1 style="font-size: 1.8rem; text-shadow: 0 0 20px #f5b642;">
      ğŸš¨ SPECIAL MISSION ğŸš¨
    </h1>
    <img class="hero" src="img/enneagram_penalty_lightstick.png" 
         style="border: 3px solid #f5b642; max-width: 320px; box-shadow: 0 0 30px rgba(245, 182, 66, 0.5);">
    
    <div class="mission-box">
      <p style="color: #fff; font-size: 1.05rem; line-height: 1.9; margin: 0;">
        æœ¬ã‚¤ãƒ™ãƒ³ãƒˆã¯<strong style="color: #f5b642;">å‚åŠ è²»0å††</strong>ã§ã™ã€‚<br>
        ãã®ä»£ã‚ã‚Šã€<strong style="color: #f5b642;">ã€Œå¾³ã‚’ç©ã‚€ã€ã¨ã„ã†åç›®ã§ã€LINEã‚¹ã‚¿ãƒ³ãƒ—ã¨ã„ã†"ãŠå¸ƒæ–½"</strong>ã‚’ã”ç”¨æ„ã—ã¦ã„ã¾ã™ã€‚
      </p>
      
      <div style="margin-top: 20px; padding-top: 20px; border-top: 1px dashed #666;">
        <p style="color: #f5b642; font-size: 1rem; margin: 0; line-height: 1.8;">
          <strong>â‘  å…¨å“¡ï¼šå¾³ã‚’ç©ã‚€ï¼ˆã‚¹ã‚¿ãƒ³ãƒ—è³¼å…¥ï¼‰</strong><br>
          <strong>â‘¡ æ•—è€…ï¼šæ©Ÿå¯†ãƒŸãƒƒã‚·ãƒ§ãƒ³ã®é‚è¡Œ</strong><br>
          <span style="color: #999; font-size: 0.85rem;">
            â€»ãƒŸãƒƒã‚·ãƒ§ãƒ³å†…å®¹ã¯å½“æ—¥ã¾ã§ç§˜åŒ¿ã€‚ã“ã®å¾Œç™ºè¡¨ã—ã¾ã™ã€‚
          </span>
        </p>
      </div>
    </div>

    <a href="${STICKER_URL}" class="btn line-btn" target="_blank" 
       style="background: linear-gradient(135deg, #f5b642, #b8860b); padding: 22px; font-size: 1.1rem;">
      ğŸ™ å¾³ã‚’ç©ã‚€ï¼ˆãŠå¸ƒæ–½ä¼šå ´ã¸ï¼‰
    </a>

    <div class="nav" style="margin-top: 25px;">
      <button class="btn sub" onclick="renderStart()" style="font-size: 0.9rem; opacity: 0.7;">
        ğŸ  æœ€åˆã«æˆ»ã‚‹
      </button>
    </div>
  `;
}

/* =========================================================
   SNSã‚·ã‚§ã‚¢æ©Ÿèƒ½
========================================================= */
function shareToX(points, percent, status) {
  const text = encodeURIComponent(
    `ç©¶æ¥µã®2æŠã‚²ãƒ¼ãƒ ã§ã€Œ${status}ã€åˆ¤å®šï¼\n` +
    `Rainyã¨ã®ã‚·ãƒ³ã‚¯ãƒ­ç‡: ${percent}% (${points}/32ç‚¹)\n\n` +
    `ã‚ãªãŸã‚‚è¨ºæ–­ã—ã¦ã¿ã‚ˆã†ï¼âœ¨\n`
  );
  const url = encodeURIComponent(window.location.href);
  const hashtags = encodeURIComponent('ç©¶æ¥µã®2æŠ,æ€§æ ¼è¨ºæ–­,ã‚¨ãƒ‹ã‚¢ã‚°ãƒ©ãƒ ');
  window.open(`https://twitter.com/intent/tweet?text=${text}&url=${url}&hashtags=${hashtags}`, '_blank');
}

function shareToLine(points, percent, status) {
  const text = encodeURIComponent(
    `ç©¶æ¥µã®2æŠã‚²ãƒ¼ãƒ ã§ã€Œ${status}ã€åˆ¤å®šï¼\n` +
    `Rainyã¨ã®ã‚·ãƒ³ã‚¯ãƒ­ç‡: ${percent}% (${points}/32ç‚¹)\n\n` +
    `ã‚ãªãŸã‚‚è¨ºæ–­ã—ã¦ã¿ã‚ˆã†ï¼âœ¨`
  );
  const url = encodeURIComponent(window.location.href);
  window.open(`https://social-plugins.line.me/lineit/share?url=${url}&text=${text}`, '_blank');
}

/* =========================================================
   ç´™å¹é›ªã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
========================================================= */
const canvas = document.getElementById('confetti-canvas');
const ctx = canvas.getContext('2d');
let particles = [];
let animationId = null;

function startConfetti() {
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
  
  particles = Array.from({ length: 150 }, () => ({
    x: Math.random() * canvas.width,
    y: Math.random() * canvas.height - canvas.height,
    r: Math.random() * 6 + 3,
    d: Math.random() * 10,
    color: ['#f5b642', '#e50914', '#06C755', '#fff', '#ffd700'][Math.floor(Math.random() * 5)],
    tilt: Math.random() * 10 - 10,
    tiltAngle: 0,
    tiltAngleIncrement: Math.random() * 0.07 + 0.05
  }));
  
  animateConfetti();
}

function animateConfetti() {
  if (particles.length === 0) return;
  
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  
  particles.forEach((p, index) => {
    p.tiltAngle += p.tiltAngleIncrement;
    p.y += (Math.cos(p.d) + 3 + p.r / 2) / 2;
    p.tilt = Math.sin(p.tiltAngle - index / 3) * 15;
    
    ctx.beginPath();
    ctx.lineWidth = p.r / 2;
    ctx.strokeStyle = p.color;
    ctx.moveTo(p.x + p.tilt + p.r / 3, p.y);
    ctx.lineTo(p.x + p.tilt, p.y + p.tilt + p.r / 5);
    ctx.stroke();
    
    if (p.y > canvas.height) {
      particles.splice(index, 1);
    }
  });
  
  if (particles.length > 0) {
    animationId = requestAnimationFrame(animateConfetti);
  }
}

function stopConfetti() {
  particles = [];
  if (animationId) {
    cancelAnimationFrame(animationId);
    animationId = null;
  }
  ctx.clearRect(0, 0, canvas.width, canvas.height);
}

/* =========================================================
   ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
========================================================= */
function escapeHtml(s) {
  return String(s ?? "")
    .replaceAll("&", "&amp;")
    .replaceAll("<", "&lt;")
    .replaceAll(">", "&gt;")
    .replaceAll('"', "&quot;")
    .replaceAll("'", "&#039;");
}

// ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ãƒªã‚µã‚¤ã‚ºå¯¾å¿œ
window.addEventListener('resize', () => {
  if (particles.length > 0) {
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
  }
});

// åˆæœŸåŒ–
renderStart();
</script>
</body>
</html>
