<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8" />
<title>ç©¶æ¥µã®2æŠ æ€§æ ¼ã‚²ãƒ¼ãƒ ï¼ˆæ–°å¹´ä¼šãƒ»å®£ä¼SPï¼‰</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<style>
  body{
    margin:0; background:#111; color:#f7f7f7;
    font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;
    display:flex; justify-content:center; align-items:center; min-height:100vh;
    overflow-x: hidden;
  }
  #confetti-canvas {
    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    pointer-events: none; z-index: 999;
  }
  .card{
    background:#181818; border:1px solid #444; border-radius:16px;
    padding:22px 20px; max-width:560px; width:95%;
    box-shadow:0 0 25px rgba(0,0,0,.6); box-sizing:border-box; text-align: center;
    position: relative; z-index: 10;
    animation: fadeIn 0.5s ease-out;
  }
  @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
  
  h1{ margin:.2em 0 .5em; font-size:1.4rem; letter-spacing:.02em; }
  .progress{ color:#aaa; font-size:.8rem; margin-bottom:.35em; text-align: left; }
  .question{ margin:1em 0; font-size:1.1rem; line-height:1.5; font-weight:700; min-height: 3em; display: flex; align-items: center; justify-content: center;}
  .choices{ display:flex; flex-direction:column; gap:12px; margin:16px 0; }
  
  .btn{
    border:none; border-radius:999px; padding:15px 18px;
    font-size:1rem; cursor:pointer; transition: transform 0.1s, background 0.2s;
    -webkit-tap-highlight-color: transparent; text-decoration: none;
  }
  .btn:active { transform: scale(0.96); }
  .choice{ background:#252525; color:#fff; border:1px solid #444; text-align:left; line-height:1.4; }
  .choice.selectedA{ border-color:#f5b642; background:rgba(245,182,66,.15); }
  .choice.selectedB{ border-color:#e50914; background:rgba(229,9,20,.15); }

  .main{ background:linear-gradient(135deg,#e50914,#f5b642); color:#111; font-weight:700; width:100%; display: block;}
  .line-btn{ background:#06C755; color:#fff; font-weight:700; width:100%; margin-bottom: 15px; display: block; text-decoration: none; text-align: center; line-height: 1.2; padding: 18px; box-sizing: border-box;}
  .sub{ background:#2a2a2a; color:#fff; border:1px solid #444; flex:1; }
  .danger{ background:#e50914; color:#fff; font-weight:700; width:100%; }
  .nav{ display:flex; gap:8px; margin-top:10px; flex-direction: column; }
  
  img.hero{ width:100%; max-width:280px; display:block; margin:10px auto; border-radius:10px; }
  .highlight{ color:#f5b642; font-weight:700; }
  .small{ font-size:.8rem; color:#ccc; margin-top: 10px; }
  
  .chart-container { position: relative; width: 180px; height: 180px; margin: 15px auto; }
  .chart-svg { transform: rotate(-90deg); }
  .chart-bg { fill: none; stroke: #333; stroke-width: 15; }
  .chart-bar { fill: none; stroke: #f5b642; stroke-width: 15; stroke-linecap: round; transition: stroke-dasharray 1s ease-out; }
  .chart-text { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); font-weight: 700; font-size: 1.2rem; }
</style>
</head>

<body>
<canvas id="confetti-canvas"></canvas>
<div class="card" id="app"></div>

<script>
/* =========================================================
   åŸºæœ¬è¨­å®š & å„ç¨®ãƒªãƒ³ã‚¯
========================================================= */
const STICKER_URL = "https://line.me/S/shop/sticker/author/5729491";
const ENNEA_URL = "https://ennea5w4.github.io/enneagram-test/"; // ã‚¨ãƒ‹ã‚¢è¨ºæ–­ç”¨ã‚¢ãƒ‰ãƒ¬ã‚¹
const rainyTypeLabel = "ä½œè€…ï¼šRainyï¼ˆã‚¿ã‚¤ãƒ—5ï¼‰";

const dogImages = {
  1: "img/dog_type01.png", 2: "img/dog_type02.png", 3: "img/dog_type03.png",
  4: "img/dog_type04.png", 5: "img/dog_type05.png", 6: "img/dog_type06.png",
  7: "img/dog_type07.png", 8: "img/dog_type08.png", 9: "img/dog_type09.png"
};
function getDogImg(t){ return dogImages[t] || dogImages[5]; }

/* =========================================================
   ãƒ‡ãƒ¼ã‚¿ï¼ˆ2æŠ32å•ï¼‰
========================================================= */
const questions32 = [
  {q:"å«Œã‚ã‚Œãªã„äººç”Ÿ vs ãªã‚ã‚‰ã‚Œãªã„äººç”Ÿ",A:"å«Œã‚ã‚Œãªã„",B:"ãªã‚ã‚‰ã‚Œãªã„"},
  {q:"ãšã£ã¨è¬ã‚Šç¶šã‘ã‚‹ vs ãšã£ã¨è¨€ã„è¨³ã—ç¶šã‘ã‚‹",A:"è¬ã‚Šç¶šã‘ã‚‹",B:"è¨€ã„è¨³ã—ç¶šã‘ã‚‹"},
  {q:"ä¸€ç”Ÿæ°—ã¾ãšã„æ²ˆé»™ vs ä¸€ç”Ÿæµ…ã„é›‘è«‡",A:"æ°—ã¾ãšã„æ²ˆé»™",B:"æµ…ã„é›‘è«‡"},
  {q:"æ¯æ—¥ä¸Šå¸ã«è©°ã‚ã‚‰ã‚Œã‚‹ vs æ¯æ—¥éƒ¨ä¸‹ã«è£åˆ‡ã‚‰ã‚Œã‚‹",A:"ä¸Šå¸ã«è©°ã‚ã‚‰ã‚Œã‚‹",B:"éƒ¨ä¸‹ã«è£åˆ‡ã‚‰ã‚Œã‚‹"},
  {q:"ä¸€ç”Ÿé ¼ã‚Œãªã„ vs ä¸€ç”Ÿé ¼ã‚‰ã‚Œã™ãã‚‹",A:"é ¼ã‚Œãªã„",B:"é ¼ã‚‰ã‚Œã™ãã‚‹"},
  {q:"ä¸€ç”Ÿæœ¬éŸ³ã—ã‹è¨€ãˆãªã„ vs ä¸€ç”Ÿã‚¦ã‚½ã—ã‹è¨€ãˆãªã„",A:"æœ¬éŸ³ã—ã‹è¨€ãˆãªã„",B:"ã‚¦ã‚½ã—ã‹è¨€ãˆãªã„"},
  {q:"ä¸€ç”Ÿäºˆå®šãŒç‹‚ã† vs ä¸€ç”Ÿäºˆå®šé€šã‚Šã§é€€å±ˆ",A:"äºˆå®šãŒç‹‚ã†",B:"äºˆå®šé€šã‚Šã§é€€å±ˆ"},
  {q:"ä¸€ç”Ÿèª¤è§£ã•ã‚Œç¶šã‘ã‚‹ vs ä¸€ç”ŸæœŸå¾…ã•ã‚Œç¶šã‘ã‚‹",A:"èª¤è§£ã•ã‚Œç¶šã‘ã‚‹",B:"æœŸå¾…ã•ã‚Œç¶šã‘ã‚‹"},
  {q:"ä¸€ç”Ÿé¸æŠã‚’è¿«ã‚‰ã‚Œã‚‹ vs ä¸€ç”Ÿé¸æŠè‚¢ãŒãªã„",A:"é¸æŠã‚’è¿«ã‚‰ã‚Œã‚‹",B:"é¸æŠè‚¢ãŒãªã„"},
  {q:"ä¸€ç”Ÿç›¸è«‡ã•ã‚Œãªã„ vs ä¸€ç”Ÿç›¸è«‡ã•ã‚Œç¶šã‘ã‚‹",A:"ç›¸è«‡ã•ã‚Œãªã„",B:"ç›¸è«‡ã•ã‚Œç¶šã‘ã‚‹"},
  {q:"ä¸€ç”Ÿè©•ä¾¡ã•ã‚Œãªã„åŠªåŠ› vs ä¸€ç”Ÿè©•ä¾¡ã•ã‚Œã‚‹å®ŸåŠ›ä¸è¶³",A:"è©•ä¾¡ã•ã‚Œãªã„åŠªåŠ›",B:"è©•ä¾¡ã•ã‚Œã‚‹å®ŸåŠ›ä¸è¶³"},
  {q:"ä¸€ç”Ÿäºˆå®šã‚’å®ˆã‚‰ã•ã‚Œã‚‹ vs ä¸€ç”Ÿäºˆå®šã‚’å®ˆã‚‰ã‚Œãªã„",A:"å®ˆã‚‰ã•ã‚Œã‚‹",B:"å®ˆã‚‰ã‚Œãªã„"},
  {q:"ä¸€ç”Ÿäººã«åˆã‚ã›ç¶šã‘ã‚‹ vs ä¸€ç”Ÿäººã«åˆã‚ã›ã¦ã‚‚ã‚‰ã†",A:"åˆã‚ã›ç¶šã‘ã‚‹",B:"åˆã‚ã›ã¦ã‚‚ã‚‰ã†"},
  {q:"ä¸€ç”Ÿå®‰å¿ƒã§ããªã„æˆåŠŸ vs ä¸€ç”Ÿå®‰å¿ƒã ã‘ã®å¤±æ•—",A:"å®‰å¿ƒã§ããªã„æˆåŠŸ",B:"å®‰å¿ƒã ã‘ã®å¤±æ•—"},
  {q:"ä¸€ç”Ÿæ³¨ç›®ã•ã‚Œç¶šã‘ã‚‹ vs ä¸€ç”Ÿå­˜åœ¨æ„Ÿã‚¼ãƒ­",A:"æ³¨ç›®ã•ã‚Œç¶šã‘ã‚‹",B:"å­˜åœ¨æ„Ÿã‚¼ãƒ­"},
  {q:"ä¸€ç”Ÿèª°ã‹ã«ä¾å­˜ã•ã‚Œã‚‹ vs ä¸€ç”Ÿèª°ã«ã‚‚é ¼ã‚‰ã‚Œãªã„",A:"èª°ã‹ã«ä¾å­˜ã•ã‚Œã‚‹",B:"èª°ã«ã‚‚é ¼ã‚‰ã‚Œãªã„"},
  {q:"ä¸€ç”Ÿå®‰å¿ƒ vs ä¸€ç”Ÿãƒ¯ã‚¯ãƒ¯ã‚¯",A:"å®‰å¿ƒ",B:"ãƒ¯ã‚¯ãƒ¯ã‚¯"},
  {q:"ä¸€ç”Ÿç†è§£ã•ã‚Œã‚‹ vs ä¸€ç”Ÿè‡ªç”±ã§ã„ã‚‰ã‚Œã‚‹",A:"ç†è§£ã•ã‚Œã‚‹",B:"è‡ªç”±ã§ã„ã‚‰ã‚Œã‚‹"},
  {q:"ä¸€ç”ŸãŠé‡‘ã«å›°ã‚‰ãªã„ vs ä¸€ç”Ÿæ™‚é–“ã«è¿½ã‚ã‚Œãªã„",A:"ãŠé‡‘ã«å›°ã‚‰ãªã„",B:"æ™‚é–“ã«è¿½ã‚ã‚Œãªã„"},
  {q:"ç§°è³›ã•ã‚Œã‚‹å¤©æ‰ vs æ„›ã•ã‚Œã‚‹å‡¡äºº",A:"ç§°è³›ã•ã‚Œã‚‹å¤©æ‰",B:"æ„›ã•ã‚Œã‚‹å‡¡äºº"},
  {q:"ä¸€ç”Ÿè‡ªä¿¡ãŒã‚ã‚‹ vs ä¸€ç”Ÿä¸å®‰ãŒãªã„",A:"è‡ªä¿¡ãŒã‚ã‚‹",B:"ä¸å®‰ãŒãªã„"},
  {q:"ä¸€ç”Ÿå¿ƒãŒç©ã‚„ã‹ vs ä¸€ç”Ÿæ„Ÿå‹•ãŒå¤šã„",A:"å¿ƒãŒç©ã‚„ã‹",B:"æ„Ÿå‹•ãŒå¤šã„"},
  {q:"ä¸€ç”Ÿå¥½ããªã“ã¨ã ã‘ vs ä¸€ç”Ÿå¾—æ„ãªã“ã¨ã ã‘",A:"å¥½ããªã“ã¨ã ã‘",B:"å¾—æ„ãªã“ã¨ã ã‘"},
  {q:"ä¸€ç”Ÿã²ã¨ã‚Šæ™‚é–“ãŸã£ã·ã‚Š vs ä¸€ç”Ÿä»²é–“ã¨ä¸€ç·’",A:"ã²ã¨ã‚Šæ™‚é–“",B:"ä»²é–“ã¨ä¸€ç·’"},
  {q:"ä¸€ç”Ÿä»Šã®ã¾ã¾ã§OKã¨è¨€ã‚ã‚Œã‚‹ vs ä¸€ç”Ÿã‚‚ã£ã¨æœŸå¾…ã•ã‚Œã‚‹",A:"ä»Šã®ã¾ã¾ã§OK",B:"ã‚‚ã£ã¨æœŸå¾…ã•ã‚Œã‚‹"},
  {q:"ä¸€ç”Ÿå¤±æ•—ã—ãªã„ vs ä¸€ç”Ÿå¾Œæ‚”ã—ãªã„",A:"å¤±æ•—ã—ãªã„",B:"å¾Œæ‚”ã—ãªã„"},
  {q:"ä¸€ç”Ÿèª°ã‹ã®ä¸€ç•ª vs ä¸€ç”Ÿã¿ã‚“ãªã«å¥½ã‹ã‚Œã‚‹",A:"èª°ã‹ã®ä¸€ç•ª",B:"ã¿ã‚“ãªã«å¥½ã‹ã‚Œã‚‹"},
  {q:"ä¸€ç”Ÿè‡ªåˆ†ã‚’ä¿¡ã˜ã‚‰ã‚Œã‚‹ vs ä¸€ç”Ÿäººã‚’ä¿¡ã˜ã‚‰ã‚Œã‚‹",A:"è‡ªåˆ†ã‚’ä¿¡ã˜ã‚‰ã‚Œã‚‹",B:"äººã‚’ä¿¡ã˜ã‚‰ã‚Œã‚‹"},
  {q:"ä¸€ç”Ÿå¿…è¦ã¨ã•ã‚Œã‚‹ vs ä¸€ç”Ÿå°Šæ•¬ã•ã‚Œã‚‹",A:"å¿…è¦ã¨ã•ã‚Œã‚‹",B:"å°Šæ•¬ã•ã‚Œã‚‹"},
  {q:"ä¸€ç”Ÿç©ã‚„ã‹ãªæ—¥å¸¸ vs ä¸€ç”Ÿå¿˜ã‚Œã‚‰ã‚Œãªã„ç¬é–“",A:"ç©ã‚„ã‹ãªæ—¥å¸¸",B:"å¿˜ã‚Œã‚‰ã‚Œãªã„ç¬é–“"},
  {q:"ä¸€ç”Ÿé¸ã°ã‚Œã‚‹å´ vs ä¸€ç”Ÿé¸ã¶å´",A:"é¸ã°ã‚Œã‚‹å´",B:"é¸ã¶å´"},
  {q:"ä¸€ç”Ÿè‡ªåˆ†ã‚’å¥½ãã§ã„ã‚‰ã‚Œã‚‹ vs ä¸€ç”Ÿæ„›ã•ã‚Œç¶šã‘ã‚‹",A:"è‡ªåˆ†ã‚’å¥½ãã§ã„ã‚‰ã‚Œã‚‹",B:"æ„›ã•ã‚Œç¶šã‘ã‚‹"}
];
const rainyAnswers32 = ["B","A","A","A","A","A","B","A","A","A","A","A","A","A","B","B","A","B","B","A","B","A","A","A","A","B","B","B","B","A","B","A"];

/* =========================================================
   ãƒ¡ã‚¤ãƒ³ãƒ­ã‚¸ãƒƒã‚¯
========================================================= */
let index32 = 0; let ans32 = [];

function renderStart(){
  stopConfetti();
  app.innerHTML = `
    <h1>ç©¶æ¥µã®2æŠ æ€§æ ¼ã‚²ãƒ¼ãƒ </h1>
    <img class="hero" src="${getDogImg(5)}" alt="ã‚¿ã‚¤ãƒ—5">
    <p class="subtitle">æ–°å¹´ä¼šã‚’ç››ã‚Šä¸Šã’ã‚‹ã€Œæ€è€ƒã‚·ãƒ³ã‚¯ãƒ­è¨ºæ–­ã€<br>ã‚ãªãŸã®è€ƒãˆã¯ä½œè€…Rainyã¨ä¸€è‡´ã™ã‚‹ã‹ï¼Ÿ</p>
    <button class="btn main" onclick="startTwoChoice()">ã‚²ãƒ¼ãƒ é–‹å§‹</button>
  `;
}

function startTwoChoice(){ index32 = 0; ans32 = []; renderQuestion32(); }

function next32() {
  if (index32 === 15) { renderTransition(); return; }
  index32++;
  if (index32 >= questions32.length) { renderResult32(); } else { renderQuestion32(); }
}
function prev32() {
  if (index32 === 0) { renderStart(); return; }
  if (index32 === 16) { renderTransition(); return; }
  index32--; renderQuestion32();
}

function renderQuestion32(){
  const q = questions32[index32]; const a = ans32[index32];
  const mode = index32 < 16 ? "åœ°ç„" : "å¤©å›½";
  app.innerHTML = `
    <div class="progress">Q${index32 + 1} / 32 [${mode}]</div>
    <div class="question">${escapeHtml(q.q)}</div>
    <div class="choices">
      <button class="btn choice ${a === 'A' ? 'selectedA' : ''}" onclick="ans32[index32]='A';renderQuestion32()">${escapeHtml(q.A)}</button>
      <button class="btn choice ${a === 'B' ? 'selectedB' : ''}" onclick="ans32[index32]='B';renderQuestion32()">${escapeHtml(q.B)}</button>
    </div>
    <div class="nav">
      <button class="btn sub" onclick="prev32()">æˆ»ã‚‹</button>
      <button class="btn danger" onclick="next32()" ${!a?'disabled':''}>${index32===31?'çµæœã¸':'æ¬¡ã¸'}</button>
    </div>
  `;
}

function renderTransition(){
  app.innerHTML = `
    <h1>åœ°ç„ãƒ¢ãƒ¼ãƒ‰çµ‚äº†ï¼</h1>
    <img class="hero" src="img/transition_hell_to_heaven.png" alt="å¤©å›½ã¸">
    <p class="subtitle">ã“ã“ã‹ã‚‰ã¯ã€Œç©¶æ¥µã®å¹¸ã›ã€ã‚’é¸ã¶<br><strong>å¤©å›½ãƒ¢ãƒ¼ãƒ‰</strong>çªå…¥ã§ã™ï¼</p>
    <button class="btn main" onclick="index32=16;renderQuestion32()">å¤©å›½ã¸é€²ã‚€ â†’</button>
  `;
}

/* =========================================================
   2æŠçµæœè¡¨ç¤ºï¼ˆä¿®æ­£ï¼šå¤–éƒ¨ã‚¨ãƒ‹ã‚¢è¨ºæ–­ã¸ã®ãƒªãƒ³ã‚¯ã‚’è¿½åŠ ï¼‰
========================================================= */
function renderResult32(){
  let rainy = 0; ans32.forEach((a,i)=>{ if(a === rainyAnswers32[i]) rainy++; });
  const percent = Math.round((rainy / 32) * 100);
  
  let status = "æ™®é€šã®äºº"; let color = "#aaa";
  if (rainy >= 26) { status = "æ™¯å“å¯¾è±¡ï¼ã‚½ã‚¦ãƒ«ãƒ¡ã‚¤ãƒˆ"; color = "#f5b642"; startConfetti(); }
  else if (rainy <= 8) { status = "ç½°ã‚²ãƒ¼ãƒ å¯¾è±¡ï¼ç•°æ˜Ÿäºº"; color = "#e50914"; }

  app.innerHTML = `
    <h1 style="color:${color}">${status}</h1>
    <div class="chart-container">
      <svg class="chart-svg" width="180" height="180">
        <circle class="chart-bg" cx="90" cy="90" r="75"></circle>
        <circle class="chart-bar" cx="90" cy="90" r="75" style="stroke-dasharray: ${471 * (percent/100)} 471; stroke: ${color}"></circle>
      </svg>
      <div class="chart-text">${rainy} pt</div>
    </div>
    <p class="subtitle">Rainyã¨ã®ã‚·ãƒ³ã‚¯ãƒ­ç‡ï¼š<strong>${percent}%</strong></p>
    
    <div class="nav">
      <a href="${ENNEA_URL}" target="_blank" class="btn main">ã‚¨ãƒ‹ã‚¢åˆ¤å®šï¼ˆå¤–éƒ¨ã‚µã‚¤ãƒˆï¼‰ã¸ â†’</a>
      <button class="btn danger" onclick="renderPenalty()">ç½°ã‚²ãƒ¼ãƒ ç™ºè¡¨ã¸ â†’</button>
      <button class="btn sub" onclick="renderStart()">TOPã¸æˆ»ã‚‹</button>
    </div>
  `;
}

/* =========================================================
   ç½°ã‚²ãƒ¼ãƒ ç”»é¢ï¼ˆãƒŸãƒƒã‚·ãƒ§ãƒ³ï¼šãŠå¸ƒæ–½ï¼†æ©Ÿå¯†ãƒŸãƒƒã‚·ãƒ§ãƒ³ï¼‰
========================================================= */
function renderPenalty(){
  stopConfetti();
  app.innerHTML = `
    <h1 style="color:#f5b642; text-shadow: 0 0 15px #f5b642; font-size:1.6rem;">ğŸš¨ SPECIAL MISSION ğŸš¨</h1>
    <img class="hero" src="img/enneagram_penalty_lightstick.png" style="border: 2px solid #f5b642; border-radius:15px; box-shadow: 0 0 20px rgba(245,182,66,0.5);">
    
    <div style="background:rgba(20,20,20,0.9); border:1px solid #f5b642; padding:20px; border-radius:12px; margin:20px 0; text-align:left;">
      <p style="color:#fff; font-size:1.0rem; line-height:1.8; margin:0;">
        æœ¬ã‚¤ãƒ™ãƒ³ãƒˆã¯<strong>å‚åŠ è²»0å††</strong>ã§ã™ã€‚<br>
        ãã®ä»£ã‚ã‚Šã€<strong>ã€Œå¾³ã‚’ç©ã‚€ã€ã¨ã„ã†åç›®ã§ã€LINEã‚¹ã‚¿ãƒ³ãƒ—ã¨ã„ã†â€œãŠå¸ƒæ–½â€</strong>ã‚’ã”ç”¨æ„ã—ã¦ã„ã¾ã™ã€‚
      </p>
      
      <div style="margin-top:15px; padding-top:15px; border-top:1px dashed #444;">
        <p style="color:#f5b642; font-size:0.9rem; margin:0;">
          <strong>â‘  å…¨å“¡ï¼šå¾³ã‚’ç©ã‚€ï¼ˆã‚¹ã‚¿ãƒ³ãƒ—è³¼å…¥ï¼‰</strong><br>
          <strong>â‘¡ æ•—è€…ï¼šæ©Ÿå¯†ãƒŸãƒƒã‚·ãƒ§ãƒ³ã®é‚è¡Œ</strong><br>
          <span style="color:#888; font-size:0.8rem;">â€»ãƒŸãƒƒã‚·ãƒ§ãƒ³å†…å®¹ã¯å½“æ—¥ã¾ã§ç§˜åŒ¿ã€‚ã“ã®å¾Œç™ºè¡¨ã—ã¾ã™ã€‚</span>
        </p>
      </div>
    </div>

    <a href="${STICKER_URL}" class="btn line-btn" target="_blank" style="background:linear-gradient(135deg, #f5b642, #b8860b); color:#fff; font-weight:700; padding:20px; text-decoration:none; border-radius:999px; display:block; box-shadow: 0 4px 15px rgba(0,0,0,0.3);">
      ğŸ™ å¾³ã‚’ç©ã‚€ï¼ˆãŠå¸ƒæ–½ä¼šå ´ã¸ï¼‰
    </a>

    <div class="nav" style="margin-top:20px;">
      <button class="btn sub" onclick="renderStart()" style="font-size:0.8rem; opacity:0.6;">æœ€åˆã«æˆ»ã‚‹</button>
    </div>
  `;
}

/* =========================================================
   æ¼”å‡ºãƒ»ãã®ä»–
========================================================= */
const canvas = document.getElementById('confetti-canvas');
const ctx = canvas.getContext('2d');
let particles = [];
function startConfetti() {
  canvas.width = window.innerWidth; canvas.height = window.innerHeight;
  particles = Array.from({length:100}, () => ({
    x: Math.random()*canvas.width, y: Math.random()*canvas.height - canvas.height,
    r: Math.random()*6+4, d: Math.random()*10,
    color: `hsl(${Math.random()*360}, 100%, 50%)`,
    tilt: Math.random()*10-10
  }));
  animateConfetti();
}
function animateConfetti() {
  if (particles.length === 0) return;
  ctx.clearRect(0,0,canvas.width,canvas.height);
  particles.forEach(p => {
    p.y += Math.cos(p.d) + 1 + p.r/2; p.tilt = Math.sin(p.d) * 15;
    ctx.beginPath(); ctx.lineWidth = p.r; ctx.strokeStyle = p.color;
    ctx.moveTo(p.x + p.tilt + p.r/4, p.y); ctx.lineTo(p.x + p.tilt, p.y + p.tilt + p.r/4);
    ctx.stroke();
    if(p.y > canvas.height) p.y = -20;
  });
  requestAnimationFrame(animateConfetti);
}
function stopConfetti() { particles = []; ctx.clearRect(0,0,canvas.width,canvas.height); }
function escapeHtml(s){ return String(s??"").replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;").replaceAll("'","&#039;"); }
renderStart();
</script>
</body>
</html>
